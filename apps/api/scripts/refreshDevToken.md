# ğŸ”„ Refreshing an Expired Dev Token

Dev Firebase ID tokens are short-lived (typically ~1 hour). If you see an authentication error such as "token expired" when calling GraphQL using an ID token generated by `create:dev-admin`, you can refresh it using the stored `refreshToken`.

## âœ”ï¸ Prerequisite

Ensure `FIREBASE_API_KEY` is defined in:

```
apps/api/.env
```

This API key must belong to the same Firebase project used by your service account.

## âœ”ï¸ Refresh the Token

Use the `refresh:dev-token` script:

```bash
npm run refresh:dev-token -- <email>
```

**Example:**

```bash
npm run refresh:dev-token -- dev.admin@example.com
```

This will:

- Load `scripts/credentials/<email>.credentials.json`
- Call Firebase's Secure Token API using the saved `refreshToken`
- Generate a new `idToken` and `refreshToken`
- Update the credentials file in place

## âœ”ï¸ After Refreshing

1. Open your updated credentials file:

   ```
   scripts/credentials/<email>.credentials.json
   ```

2. Copy the new `idToken`, then update Apollo Sandbox headers:

   ```
   authorization: Bearer <new-idToken>
   ```

You are now authenticated again.

## âœ”ï¸ Summary

- ID tokens expire after ~1 hour
- When expired â†’ run `refresh:dev-token` with the same email
- Update your Apollo Authorization header with the new `idToken`
